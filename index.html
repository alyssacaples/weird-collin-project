<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>goodbye collin</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    img {
      max-width: 100%;
      height: auto;
      transition: opacity 0.5s ease;
    }
    .message {
      font-size: 24px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>COLLIN IS DEAD TO ME</h1>
  <div id="image-container">
      <h2> click to see him disappear forever</h2>
    <img id="main-image" src="collin.PNG" alt="Main Image">
  </div>
  <div class="message" id="message"></div>

   <!-- Add an audio element for the song -->
   <audio id="gravestone-audio" src="angel.mp3"></audio>

  <script>
    let visitorCount = 0; // Initialize visitor count
    const startTime = new Date(); // Record the start time
  
    // Get image and message elements
    const image = document.getElementById('main-image');
    const message = document.getElementById('message');
    const audio = document.getElementById('gravestone-audio');

    // High score feature    // Add click event listener to the image
    image.addEventListener('click', () => {
      visitorCount++; // Increment visitor count
    
      // Calculate opacity
      const opacity = Math.max(1 - visitorCount / 15, 0);
    
      if (opacity > 0) {
        // Update image opacity
        image.style.opacity = opacity;
      } else {
        // Replace image with gravestone and display message
        const endTime = new Date();
        const liveTimeSeconds = (endTime - startTime) / 1000; // Time in seconds with milliseconds
        image.src = "rip.png"; // Replace with your gravestone image
        image.style.opacity = 1;
    
        // Check if the time qualifies for the top 10
        const highScores = getHighScores();
        const qualifiesForHighScore =
          highScores.length < maxHighScores ||
          liveTimeSeconds < highScores[highScores.length - 1].time;
    
        if (qualifiesForHighScore) {
          // Prompt for initials
          const initials = prompt(
            "Congratulations! You made the top 10! Enter your initials:"
          );
          if (initials) {
            updateHighScores(liveTimeSeconds, initials);
          }
        }
    
        // Display the high scores
        message.innerHTML = `RIP COLLIN<br>he was alive for ${liveTimeSeconds.toFixed(3)} seconds.<br>`;
        message.innerHTML += displayHighScores();
      }
    });
    const highScoresKey = "collinHighScores"; // Key for localStorage
    const maxHighScores = 10; // Maximum number of high scores to keep

    // Function to get high scores from localStorage
    function getHighScores() {
        const highScores = JSON.parse(localStorage.getItem(highScoresKey)) || [];
        return highScores;
    }

    // Function to save high scores to localStorage
    function saveHighScores(highScores) {
        localStorage.setItem(highScoresKey, JSON.stringify(highScores));
    }

    // Function to update the high score list
    function updateHighScores(time, initials) {
        const highScores = getHighScores();
        highScores.push({ time, initials });
        highScores.sort((a, b) => a.time - b.time); // Sort by fastest time
        if (highScores.length > maxHighScores) {
            highScores.pop(); // Remove the slowest time if we exceed maxHighScores
        }
        saveHighScores(highScores);
    }

       // Function to display high scores
    function displayHighScores() {
        const highScores = getHighScores();
        let highScoresHTML = "<h3>Top 10 Times</h3><ul>";
        highScores.forEach((score, index) => {
            highScoresHTML += `<li>${index + 1}. ${score.initials} - ${score.time.toFixed(3)} seconds</li>`;
        });
        highScoresHTML += "</ul>";
        return highScoresHTML;
    }

    // Add click event listener to the image
    image.addEventListener('click', () => {
      visitorCount++; // Increment visitor count
    
      // Calculate opacity
      const opacity = Math.max(1 - visitorCount / 15, 0);

      let isGameOver = false; 
    
      if (opacity > 0) {
        // Update image opacity
        image.style.opacity = opacity;
      } else {
        if( !isGameOver) {}
        if (qualifiesForHighScore) {
                // Prompt for initials
                const initials = prompt(
                    "Congratulations! You made the top 10! Enter your initials:"
                );
                if (initials) {
                    updateHighScores(liveTimeSeconds, initials);
                }
            }
        // Replace image with gravestone and display message
       // const endTime = new Date();
        image.src = "rip.png"; // Replace with your gravestone image
        image.style.opacity = 1;
                // Replace image with gravestone and display message
        const endTime = new Date();
        const liveTimeSeconds = (endTime - startTime) / 1000; // Time in seconds with milliseconds
        const liveTimeMilliseconds = (endTime - startTime) % 1000; // Remaining milliseconds
        message.innerHTML = `RIP COLLIN <br>he was alive for ${liveTimeSeconds}.${liveTimeMilliseconds} seconds.`;
        message.innerHTML += displayHighScores();
        
    // Randomly select a song
      const songs = ['duster.mp3', 'angel.mp3', 'taps.mp3']; // Replace with your song file names
      const randomSong = songs[Math.floor(Math.random() * songs.length)];
      audio.src = randomSong; // Set the selected song as the audio source
      audio.play(); // Play the selected song

      isGameOver = true;
      }
    
      // // Add a new high score
      // const addHighScore = (time, initials) => {
      //   fetch('/high-scores', {
      //     method: 'POST',
      //     headers: {
      //       'Content-Type': 'application/json'
      //     },
      //     body: JSON.stringify({ time, initials })
      //   })
      //     .then(response => response.json())
      //     .then(updatedHighScores => {
      //       highScores = updatedHighScores;
      //     });
      // };
    
      // // Get high scores
      // const getHighScores = () => {
      //   fetch('/high-scores')
      //     .then(response => response.json())
      //     .then(scores => {
      //       highScores = scores;
      //     });
      // };
    
      // // Call the getHighScores function to retrieve the high scores
      // getHighScores();
    
      // // Update the high scores display
      // const updateHighScoresDisplay = () => {
      //   const highScoresList = document.getElementById('high-scores-list');
      //   highScoresList.innerHTML = '';
    
      //   highScores.forEach(score => {
      //     const listItem = document.createElement('li');
      //     listItem.textContent = `${score.initials} - ${score.time} seconds`;
      //     highScoresList.appendChild(listItem);
      //   });
      // };
    
      //   // Add event listener to the submit button
      //   const submitButton = document.getElementById('submit-button');
      //   submitButton.addEventListener('click', () => {
      //   const initialsInput = document.getElementById('initials-input');
      //   const initials = initialsInput.value;
      //   const time = liveTimeSeconds;
    
        // Call the addHighScore function to add the new high score
      //  addHighScore(time, initials);
    
        // Update the high scores display
       // updateHighScoresDisplay();
      });
</script>
</body>
</html>